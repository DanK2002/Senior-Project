{% load static %}
<link rel="stylesheet" href="{% static 'managerial.css' %}">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
      .sidenav {
        height: 100%;
        width: 160px;
        position: fixed;
        z-index: 1;
        top: 0;
        left: 0;
        background-color: #111;
        overflow-x: hidden;
        padding-top: 20px;
      }
      
      .sidenav a {
        padding: 6px 8px 6px 16px;
        text-decoration: none;
        font-size: 25px;
        color: #dfd0d0;
        display: block;
      }
      
      .sidenav a:hover {
        color: #f1f1f1;
      }
      
      .main {
        margin-left: 160px; /* Same as the width of the sidenav */
        font-size: 28px; /* Increased text to enable scrolling */
        padding: 80px 160px;
      }
        
      @media screen and (max-height: 450px) {
        .sidenav {padding-top: 15px;}
        .sidenav a {font-size: 18px;}
      }
      body {
        padding-left: 160px;
      }
</style>
<script src="https://unpkg.com/htmx.org@1.9.10"></script> 
</head>

<body hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
  <div class="sidenav">
    <a><u>Categories</u></a>
    <a href="{% url 'basic:manageemployees' %}">Employees</a>
    <a><b>Menu</b></a>
    <a href="{% url 'basic:inventory' %}">Inventory</a>
    <a href="{% url 'basic:sales' %}">Sales</a>
  </div>

  <div class = "container">
  <h1>Manage Menu</h1>
  
  <div class = "secondary-container">
  <!-- Display Selected Category -->
  <div class="selected-category-container">
    <p>Category: {{ selected_category }}</p>
  </div>

  <!-- Drop-down list for categories -->
  <form class="category-dropdown form-input" method="post">
    {% csrf_token %}
    <label for="category">Category:</label>
    <select id="category" name="category">
      <option value="">Select a Category</option>
      {% for category in categories %}
        <option value="{{ category }}" {% if selected_category == category %} selected {% endif %}>{{ category }}</option>
      {% endfor %}
    </select>
    <button type="submit" class = "btn">Update Category</button>
  </form>

  <!-- Drop down list for meals -->
  <form class="meal-dropdown" method="get" 
  hx-target = "#add-meal-container"
  hx-swap ="outerHTML"
  hx-trigger="change"
  action="{% url 'basic:fetch_meal_details' %}">
    {% csrf_token %}
    <label for="meal_name">Meals:</label>
    <select id="meal_name" name="meal_name" hx-get="{% url 'basic:fetch_meal_details' %}" hx-trigger="change">
      <option value="">Select a Meal</option>
      {% for meal in meals %}
      <option value="{{ meal.name }}">{{ meal.name }}</option>
      {% endfor %}
    </select>
  </form>

  <!-- Drop down list for food items in selected category -->
<form class="food-dropdown" method="post" 
hx-target = "#add-food-container"
hx-swap ="outerHTML"
hx-trigger="change"
    hx-get="{% url 'basic:fetch_food_details' %}"> 
    {% csrf_token %}
    <label for="food_name">Foods:</label>
    <select id="food_name" name="food_name" hx-post="category">
      <option value="">Select a Food</option>
      {% for food in foods %}
        <option value="{{ food.name }}" {% if selected_food == food %} selected {% endif %}>{{ food.name }}</option>
        {% endfor %}
      </select>
    <input type="hidden" name="category" value="{{ selected_category }}">
  </form>
  
  <!-- Edit Category Button -->
  <div hx-target="#edit-category-response" hx-swap="outerHTML">
    <button class = "btn" id="edit-category-button" hx-get="{% url 'basic:edit_category_form' %}?selected_category={{ selected_category }}">Edit Category Name</button>
  </div>
  

  
  
  <!-- Edit Category Form Placeholder -->
  <div id="edit-category-response">
    
  </div>
  </div>

  <div class = "secondary-container">
  <!-- Add food form to add a new food -->
  <div id="add-food-container" hx-target="view-food-details" hx-swap="outerHTML">
    {% include 'basic/partials/add_food.html' %}
  </div>
  <!--Replaces add food form with details of selected food item -->
  <div id="food-details">
    <div id="view-food-details"></div>
  </div>
  <!-- Add Meal form -->
  <div id="add-meal-container" hx-target="view-meal-details" hx-swap="outerHTML">
    {% include 'basic/partials/add_meal.html' %}
  </div>
  <!--Edit/view food form-->
  <div id="meal-details">
    <div id="view-meal-details"></div>
  </div>
  
</body>